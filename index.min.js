/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2024 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t="undefined"!=typeof globalThis?globalThis:t||self).TagPicker=t.TagPicker||{},t.TagPicker.Sort=e())}(this,(function(){"use strict";var t=function(t){return"function"==typeof t},e=function(t,e){return void 0===e&&(e=!0),!(!t||"object"!=typeof t)&&(!e||function(t,e){return!(!t||"object"!=typeof t)&&r(e)&&r(t.constructor)&&e===t.constructor}(t,Object))},r=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},n=function(t){return t.replace(/[-_.](\w)/g,(function(t,e){return o(e)}))},o=function(t){return t.toUpperCase()},i=function(t){if(function(t){return Array.isArray(t)}(t))return t.map((function(e){return i(t)}));if(e(t)){for(var r in t)t[r]=i(t[r]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},a=function(t,e){return t.style[n(e)]=null,t},u=function(t,e,r){return t.style[n(e)]=i(r),t},c=new WeakMap;function s(t){return c.get(t)}function f(t){var e=this._picker._active,r=t.from,n=t.to;e&&(r&&a(r,"cursor"),n&&a(n,"cursor"))}function l(t){var e=this._picker,r=e._active,n=e._mask.text;if(r)return t.related!==n&&void 0}function v(t){var e,r=this._picker,n=r._active,o=r.self,i=r.state;i.n;var a=t.item;if(n){var u=this.toArray().slice(0,-1);o.value=u.join(i.join),r.fire("sort.tag",[e=a.title]).fire("change",[e]),r.value=r.value}}function p(t){var e=this._picker._active,r=t.from,n=t.to;e&&(r&&u(r,"cursor","move"),n&&u(n,"cursor","move"))}return{attach:function(){var e=this,r=e.constructor.prototype;!t(r.reverse)&&(r.reverse=function(){var t=this,e=s(t),r=t._active,n=t.self,o=t.state.join;if(!r)return t;var i=e.toArray(),a=i.pop();return i=i.reverse(),n.value=i.join(o),e.sort(i.concat(a),!0),t.fire("sort.tags",[i])}),!t(r.sort)&&(r.sort=function(t){var e=this,r=s(e),n=e._active,o=e.self,i=e.state.join;if(!n)return e;t=(t||function(t,e){return t.localeCompare(e,void 0,{numeric:!0,sensitivity:"base"})}).bind(e);var a=r.toArray(),u=a.pop();return a=a.sort(t),o.value=a.join(i),r.sort(a.concat(u),!0),e.fire("sort.tags",[a])});var n,o,i=e._mask,a=e.state,u=i.tags,d=a.n,h=d+"__tag--",_=new Sortable(u,{animation:150,chosenClass:h+"select",dataIdAttr:"title",dragClass:h+"move",filter:"."+d+"__text",ghostClass:h+"ghost",onEnd:f,onMove:l,onSort:v,onStart:p,selectedClass:h+"selected"});return _._picker=e,n=e,o=_,c.set(n,o),e},detach:function(){var t,e=s(this);t=this,c.delete(t),e&&e.destroy()},name:"TagPicker.Sort"}}));