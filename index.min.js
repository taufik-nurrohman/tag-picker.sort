/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2025 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((t="undefined"!=typeof globalThis?globalThis:t||self).TagPicker=t.TagPicker||{},t.TagPicker.Sort=n())}(this,(function(){"use strict";function t(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function n(n,e,r){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var o=e.length;return t(e,r<o?r:o)}return n(e,r)}function e(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,u,a=[],f=!0,c=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;f=!1}else for(;!(f=(r=i.call(e)).done)&&(a.push(r.value),a.length!==n);f=!0);}catch(t){c=!0,o=t}finally{try{if(!f&&null!=e.return&&(u=e.return(),Object(u)!==u))return}finally{if(c)throw o}}return a}}(t,n)||r(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(n,e){if(n){if("string"==typeof n)return t(n,e);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(n,e):void 0}}var o=function(t){return Array.isArray(t)},i=function(t){return"function"==typeof t},u=function(t,n){return void 0===n&&(n=!0),!(!t||"object"!=typeof t)&&(!n||function(t,n){return!(!t||"object"!=typeof t)&&a(n)&&a(t.constructor)&&n===t.constructor}(t,Object))},a=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},f=function(t){if(o(t))return t.map((function(n){return f(t)}));if(u(t)){for(var n in t)t[n]=f(t[n]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},c=function(t){return t.replace(/[-_.](\w)/g,(function(t,n){return l(n)}))},l=function(t){return t.toUpperCase()},s=function(t,n){for(var e,r=0,o=function(t){return t.length}(t);r<o;++r)if(-1!==(e=n(t[r],r))){if(0===e)break}else t.splice(r,1);return t},v=function(t,o){for(var i,u=function(t){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=r(t))||t&&"number"==typeof t.length){n&&(t=n);var e=0;return function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);!(i=u()).done;){var a=n(e,i.value,2),f=a[0],c=a[1];if(-1!==(c=o(c,f))){if(0===c)break}else h(f,t)}return t},d=function(t,n){var e;for(var r in t)if(-1!==(e=n(t[r],r))){if(0===e)break}else delete t[r];return t},p=function(t){return m(t,_)||null},m=function(t,n){return n.get(t)},y=function(t){return h(t,_)},h=function(t,n){return n.delete(t)},g=function(t,n){return b(t,n,_)},b=function(t,n,e){return e.set(t,n)},_=new WeakMap;var x=document,j=window,w=x.body,A=x.documentElement,k=function(t,n){return e=(n||x).querySelectorAll(t),Array.from(e);var e},S=function(t,n){return n?t.closest(n)||null:t.parentNode||null},T=function(t,n){return t["previous"+(n?"":"Element")+"Sibling"]||null},E=function(t,n){return t.classList.contains(n)},O=function(t,n){return t.removeAttribute(n),t},I=function(t){var n=S(t);return t.remove(),n},L=function(t){return O(t,"id")},P=function(t,n){return t.style[c(n)]=null,t},C=function(t,n){return n?o(n)?(s(n,(function(n){return P(t,n)})),t):u(n)?(d(n,(function(n,e){return n&&P(t,e)})),t):t:O(t,"style")},X=function(t,n){return t.append(n),n},Y=function(t,n,e){return function(t){return"number"==typeof t}(e)&&(e+="px"),t.style[c(n)]=f(e),t},M=function(t,n){return d(n,(function(n,e){n||""===n||0===n?Y(t,e,n):P(t,e)})),t},N=function(t,n){return function(){var e=arguments,r=this;setTimeout((function(){return t.apply(r,e)}),n)}},z=function(t){var n,e,r,o,i,u,a;return!function(t){return t===j}(t)?(o=(e=t.getBoundingClientRect()).left,i=e.top,r=e.width,n=e.height,u=e.right,a=e.bottom):(o=t.pageXOffset||A.scrollLeft||w.scrollLeft,i=t.pageYOffset||A.scrollTop||w.scrollTop,r=t.innerWidth,n=t.innerHeight),[o,i,r,n,u,a]},U=function(t,n,e){n.removeEventListener(t,e)},W=function(t){return t&&t.preventDefault()},q=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},B={},D="move",F="mouse",H=F+"down",R=F+D,$=F+"up",G="touch",J=G+"end",K=G+D,Q=G+"start";var V,Z,tt,nt,et=0,rt=0;function ot(t){W(t);var n=this,e=p(n).state.n,r=t,o=r.target,i=r.type;if(!E(o,e+"__x")&&!S(o,"."+e+"__x")){q(R,x,it),q($,x,ut),q(J,x,ut),q(K,x,it),Q===i&&(t=t.touches[0]),Z=t.clientX-et,nt=t.clientY-rt,L(V=n.cloneNode(!0)),tt=z(n),g(V,n),Y(n,"visibility","hidden"),M(V,{height:tt[3],left:tt[0],"pointer-events":"none",position:"fixed",top:tt[1],transform:!1,transition:!1,width:tt[2],"z-index":9999}),X(w,V);for(var u,a=n;(u=S(a))&&(M(a=u,{cursor:"move",overflow:"hidden"}),w!==a););}}function it(t){if(V){W(t);var n,e,r=p(V),o=p(r),i=o._mask,u=o.state,a=i.flex,f=u.n;K===t.type&&(t=t.touches[0]),et=t.clientX-Z,rt=t.clientY-nt,n=x.elementFromPoint(t.clientX,t.clientY),E(n,f+"__tag")||(n=(e=S(n,"."+f+"__tag"))?e:0),st(V,et,rt),n&&n!==r&&a===S(n)&&(tt=z(n),Y(n,"transition","transform 150ms"),!function(t,n){var e;for(e=T(t,1);e;e=T(e,1))if(e===n)return 1;return 0}(r,n)?(st(n,-tt[2],0),N((function(t,n){C(n,["transform","transition"]),function(t,n){t.after(n)}(n,t)}),150)(r,n)):(st(n,tt[2],0),N((function(t,n){C(n,["transform","transition"]),function(t,n){t.before(n)}(n,t)}),150)(r,n)))}}function ut(t){if(U(R,x,it),U($,x,ut),U(J,x,ut),U(K,x,it),V){var n,e,r,o;for(P(n=p(V),"visibility"),r=p(n),o=n.value;(e=S(n))&&(C(n=e,["cursor","overflow"]),w!==n););if(y(V),I(V),r){var i,u=new Map,a=r,c=a._mask,l=a._tags,v=a.self,d=a.state,m=c.flex,h=d.join,g=[];s(k("data[value]",m),(function(t){b(i=t.value,l.at(i),u),g.push(i)})),function(t,n){null===n?O(t,"value"):t.value=f(n)}(v,g.join(h)),l.values=u,r.fire("sort.tag",[o])}}V=et=rt=0}function at(t){var n=this.tags.at(t);(n=n&&n[2])&&(y(n),U(H,n,ot),U(Q,n,ot))}function ft(t){var n=this.tags.at(t);(n=n&&n[2])&&(q(H,n,ot),q(Q,n,ot),g(n,this))}function ct(t,n){v(t,(function(t){var e=B[t[2].value],r=z(t[2]);N((function(t,n){I(t),P(n[2],"visibility")}),n)(e,t),Y(t[2],"visibility","hidden"),Y(e,"transition-duration",n+"ms"),st(e,r[0],r[1])}))}function lt(t,n){v(t,(function(t){var e=L(t[2].cloneNode(!0)),r=z(t[2]);B[t[2].value]=e,M(e,{height:r[3],left:0,position:"fixed",top:0,transition:"transform 0s",width:r[2],"z-index":9999}),st(e,r[0],r[1]),X(n,e)}))}function st(t,n,e){Y(t,"transform","translate("+n+"px,"+e+"px)")}return{attach:function(t,n){var e=this,r=e.constructor._;e._mask;var o=e._tags;return v(o,(function(t){t=t[2],q(H,t,ot),q(Q,t,ot),g(t,e)})),!i(r.reverse)&&(r.reverse=function(){var t=this,n=t._mask,e=t._tags,r=t.state,o=t.value,i=n.flex,u=r.join;return lt(e,i),o=o.split(u).reverse(),t.value=o.join(u),ct(e,150),t.fire("sort.tags",[o])}),!i(r.sort)&&(r.sort=function(t){t=(t||function(t,n){return t.localeCompare(n,void 0,{numeric:!0,sensitivity:"base"})}).bind(n);var n=this,e=n._mask,r=n._tags,o=n.state,i=n.value,u=e.flex,a=o.join;return i!==(i=i.split(a).sort(t)).join(a)?(lt(r,u),n.value=i.join(a),ct(r,150),n.fire("sort.tags",[i])):n}),e.on("let.tag",at).on("set.tag",ft)},detach:function(){var t=this,n=t.constructor._,e=t._tags;return v(e,(function(t){t=t[2],y(t),U(H,t,ot),U(Q,t,ot)})),delete n.reverse,delete n.sort,t.off("let.tag",at).off("set.tag",ft)},name:"TagPicker.Sort"}}));