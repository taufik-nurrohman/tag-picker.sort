/*!
 *
 * The MIT License (MIT)
 *
 * Copyright © 2025 Taufik Nurrohman <https://github.com/taufik-nurrohman>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the “Software”), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((t="undefined"!=typeof globalThis?globalThis:t||self).TagPicker=t.TagPicker||{},t.TagPicker.Sort=n())}(this,(function(){"use strict";function t(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function n(n,e,r){if(e&&!Array.isArray(e)&&"number"==typeof e.length){var o=e.length;return t(e,r<o?r:o)}return n(e,r)}function e(n,e){return function(t){if(Array.isArray(t))return t}(n)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,o,i,u,f=[],a=!0,c=!1;try{if(i=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;a=!1}else for(;!(a=(r=i.call(e)).done)&&(f.push(r.value),f.length!==n);a=!0);}catch(t){c=!0,o=t}finally{try{if(!a&&null!=e.return&&(u=e.return(),Object(u)!==u))return}finally{if(c)throw o}}return f}}(n,e)||function(n,e){if(n){if("string"==typeof n)return t(n,e);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(n,e):void 0}}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var r=function(t){return"function"==typeof t},o=function(t,n){return void 0===n&&(n=!0),!(!t||"object"!=typeof t)&&(!n||function(t,n){return!(!t||"object"!=typeof t)&&i(n)&&i(t.constructor)&&n===t.constructor}(t,Object))},i=function(t){return function(t){return void 0!==t}(t)&&!function(t){return null===t}(t)},u=function(t){if(function(t){return Array.isArray(t)}(t))return t.map((function(n){return u(t)}));if(o(t)){for(var n in t)t[n]=u(t[n]);return t}return!1===t?"false":null===t?"null":!0===t?"true":""+t},f=function(t){return t.replace(/[-_.](\w)/g,(function(t,n){return a(n)}))},a=function(t){return t.toUpperCase()},c=function(t,r){for(var o=t.entries(),i=o.next();!i.done;){var u=n(e,i.value,2),f=u[0],a=u[1];if(-1===(a=r.call(t,a,f)))d(f,t);else if(0===a)break;i=o.next()}return t},l=function(t){return s(t,y)||null},s=function(t,n){return n.get(t)},v=function(t){return d(t,y)},d=function(t,n){return n.delete(t)},p=function(t,n){return g(t,n,y)},g=function(t,n,e){return e.set(t,n)},y=new WeakMap;var h=document,m=window,b=h.body,_=h.documentElement,j=function(t,n){return e=(n||h).querySelectorAll(t),Array.from(e);var e},x=function(t,n){return n?t.closest(n)||null:t.parentNode||null},A=function(t,n){return t["previous"+(n?"":"Element")+"Sibling"]||null},k=function(t,n){return t.classList.contains(n)},w=function(t,n){return t.removeAttribute(n),t},S=function(t,n){return t.style[f(n)]=null,t},T=function(t,n,e){return function(t){return"number"==typeof t}(e)&&(e+="px"),t.style[f(n)]=u(e),t},O=function(t){var n,e,r,o,i,u,f;return!function(t){return t===m}(t)?(o=(e=t.getBoundingClientRect()).left,i=e.top,r=e.width,n=e.height,u=e.right,f=e.bottom):(o=t.pageXOffset||_.scrollLeft||b.scrollLeft,i=t.pageYOffset||_.scrollTop||b.scrollTop,r=t.innerWidth,n=t.innerHeight),[o,i,r,n,u,f]},E=function(t,n,e){n.removeEventListener(t,e)},L=function(t){return t&&t.preventDefault()},P=function(t,n,e,r){void 0===r&&(r=!1),n.addEventListener(t,e,r)},C="move",X="mouse",Y=X+"down",I=X+C,M=X+"up",N="touch",U=N+"end",W=N+C,q=N+"start";var z,B,D,F,H=0,R=0;function $(t){L(t);var n=this,e=l(n),r=e._mask,o=e.state,i=r.flex,u=o.n,f=t,a=f.target,c=f.type;if(!k(a,u+"__x")&&!x(a,"."+u+"__x")){var s;n.blur(),P(I,h,G),P(M,h,J),P(U,h,J),P(W,h,G),q===c&&(t=t.touches[0]),B=t.clientX-H,F=t.clientY-R,s=z=n.cloneNode(!0),w(s,"id"),D=O(n),p(z,n),T(n,"visibility","hidden"),function(t,n){(function(t,n){var e;for(var r in t)if(-1!==(e=n.call(t,t[r],r))){if(0===e)break}else delete t[r]})(n,(function(n,e){n||""===n||0===n?T(t,e,n):S(t,e)}))}(z,{height:D[3],left:D[0],"pointer-events":"none",position:"fixed",top:D[1],transform:!1,transition:!1,width:D[2],"z-index":9999}),function(t,n){t.append(n)}(i,z);for(var v,d=n;(v=x(d))&&(T(d=v,"cursor","move"),b!==d););}}function G(t){if(L(t),z){var n,e,r=l(z),o=l(r),i=o._mask,u=o.state,f=i.flex,a=u.n;W===t.type&&(t=t.touches[0]),H=t.clientX-B,R=t.clientY-F,n=h.elementFromPoint(t.clientX,t.clientY),k(n,a+"__tag")||(n=(e=x(n,"."+a+"__tag"))?e:0),function(t,n,e){T(t,"transform","translate("+n+"px,"+e+"px)")}(z,H,R),n&&n!==r&&f===x(n)&&(function(t,n){var e;for(e=A(t,1);e;e=A(e,1))if(e===n)return 1;return 0}(r,n)?function(t,n){t.after(n)}(r,n):function(t,n){t.before(n)}(r,n))}}function J(t){if(E(I,h,G),E(M,h,J),E(U,h,J),E(W,h,G),z){var n,e,r,o;for(S(n=l(z),"visibility"),r=l(n),o=n.value,U!==t.type&&n.focus();(e=x(n))&&(S(n=e,"cursor"),b!==n););if(v(z),function(t){var n=x(t);t.remove()}(z),r){var i,f=new Map,a=r,c=a._mask,s=a._tags,d=a.self,p=a.state,y=c.flex,m=p.join,_=[];!function(t,n){for(var e,r=0,o=function(t){return t.length}(t);r<o;++r)if(-1!==(e=n.call(t,t[r],r))){if(0===e)break}else t.splice(r,1)}(j("data[value]",y),(function(t){g(i=t.value,s.at(i),f),_.push(i)})),function(t,n){null===n?w(t,"value"):t.value=u(n)}(d,_.join(m)),s.values=f,r.fire("sort.tag",[o])}}z=H=R=0}function K(t){var n=this.tags.at(t);(n=n&&n[2])&&(v(n),E(Y,n,$),E(q,n,$))}function Q(t){var n=this.tags.at(t);(n=n&&n[2])&&(P(Y,n,$),P(q,n,$),p(n,this))}return{attach:function(t,n){var e=this,o=e.constructor._,i=e._tags;return c(i,(function(t){t=t[2],P(Y,t,$),P(q,t,$),p(t,e)})),!r(o.reverse)&&(o.reverse=function(){var t=this,n=t.state,e=t.value,r=n.join;return e?(e=e.split(r).reverse(),t.value=e.join(r),t.fire("sort.tags",[e])):t}),!r(o.sort)&&(o.sort=function(t){var n,e=this,r=e.state,o=e.value,i=r.join;return t=(t||function(t,n){return t.localeCompare(n,void 0,{numeric:!0,sensitivity:"base"})}).bind(e),(n=o)&&n!==(o=o.split(i).sort(t)).join(i)?(e.value=o.join(i),e.fire("sort.tags",[o])):e}),e.on("let.tag",K).on("set.tag",Q)},detach:function(){var t=this,n=t.constructor._,e=t._tags;return c(e,(function(t){t=t[2],v(t),E(Y,t,$),E(q,t,$)})),delete n.reverse,delete n.sort,t.off("let.tag",K).off("set.tag",Q)},name:"TagPicker.Sort"}}));